<!doctype html>
<html>
  <head>
    <title>litr8r</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial;background: #285F19 !important; }
      form { background: #000; padding: 3px; bottom: 50vh; width: 100%; }
      form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
      form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
      .no-padding {
          padding: 0;
          background: none;
      }
      h1.yoglimogli {
          padding: 3vh !important;
          -webkit-text-stroke: 0 !important;
          color: #ddd;
      }
    </style>
        <link rel="stylesheet" href="/public/css/normalize.min.css">
        <link rel="stylesheet" href="/public/css/main-1.6.css">

        <script src="/public/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>

  </head>
  <body>
    <section id="preview" class="clearfix">

	<h1 class="subtitles" id="preview-messages">
	This is your preview. You can see what your translation string is going to look like before you send it to the output screen. press Enter to send you translation string to the screen. 
	</h1>

    </section>

    <section id="subtitles" class="clearfix">

	<h1 class="subtitles " id="messages">
	This is where you see the output that is on screen. If you'd like to clear it, just press Enter without typing anything. 
	</h1>

    </section>
    <section class="no-padding">
        <h1 class="subtitles yoglimogli" id="nextphrase">
        This is where you see the output that is on screen. If you'd like to clear it, just press Enter without typing anything. 
        </h1>
        <form action="">
          <input id="m" autocomplete="off" /><button>Send</button>
        </form>
        <h1 class="subtitles yoglimogli" id="prevphrase">
        This is where the previous saved phrase is displayed. Next phrase is above form.
        </h1>
    </section>
      <script src="/socket.io/socket.io.js"></script>
      <script src="/public/js/jquery-2.1.3.js"></script>
      <script>
	$( document ).ready(function() {
	  $( "#m" ).focus();
	});
	var socket = io();
	$('form').submit(function(){
	  socket.emit('chat message', $('#m').val());
	  $('#m').val('');
	  return false;
	});
	$('form').keyup(function(){
	  $('#preview-messages').empty();
	  $('#preview-messages').append($('#m').val());
	});
	socket.on('chat message', function(msg){
	  $('#messages').empty();
	  $('#messages').append(msg);
	});
	//get phrases JSON and be available to scripts
	var savedphrases, len;
	$.getJSON('/phrases.json', function(res){
	    console.log(res);
	    savedphrases = res;
	    len = savedphrases.textsArray.length;
        if (len > 0)
            $('#nextphrase').text(savedphrases.textsArray[0]);
        else
            $('#nextphrase').text('saved phrases buffer is empty');
	});
	//scroll through phrases
	var currentindex = -1, screenbuffer = [
	        'This is where the previous saved phrase is displayed, press down key to get it into the form',
	        'type here instead of this text or press Enter to send it to screen',
	        'This is where the next saved phrase is displayed, press up key to get it into the form'
	    ];
    bufferstatus('initializing currentindex and screenbuffer');
	function bufferstatus(message){
        console.log(message);
        console.log('currentindex: ' + currentindex);
        console.log('screenbuffer:' + screenbuffer);
	}
	$("body").keydown(function(e) { 
        switch(e.keyCode){
            case 38:
                //arrow up was fired
                //load previous phrase in buffer into form input and preview buffer zone
                //load next phrase in buffer to preview-next and previous phrase to preview-prev
                currentindex += 1;
                screenbuffer.unshift(savedphrases.textArray[currentindex]);
                $('#nextphrase').text(screenbuffer[0]);
                $('#m').val(screenbuffer[1]);
                $('#prevphrase').text(screenbuffer[2]);
                e.preventDefault();
                break;
            case 40:
                //arrow down was fired
                //load next phrase in buffer into form input and preview buffer zone
                //load previous phrase in buffer to preview-previous and next phrase to preview-next
                currentindex -= 1;
                screenbuffer.shift();
                $('#nextphrase').text(screenbuffer[0]);
                $('#m').val(screenbuffer[1]);
                $('#prevphrase').text(screenbuffer[2]);
                e.preventDefault();
                break;
            default:
                $('#nextphrase').text(screenbuffer[0]);
                $('#m').val(screenbuffer[1]);
                $('#prevphrase').text(screenbuffer[2]);
        }
    });
    
      </script>
      <script>
	/*
	//check if jquery is available for client
	window.onload = function() {
	    if (window.jQuery) {  
		// jQuery is loaded  
		alert("Yeah!");
	    } else {
		// jQuery is not loaded
		alert("Doesn't Work");
	    }
	}      
	*/
      </script>
    </body>
</html>